<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CSV 上傳工具 - Business UI</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Choices.js CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
</head>

<body class="h-screen flex flex-col bg-gray-100">

  <!-- Header -->
  <header class="p-6 bg-white shadow flex-none">
    <h1 class="text-3xl font-bold text-gray-800 tracking-wide">CSV 上傳工具</h1>
  </header>

  <!-- Main Content -->
  <main class="flex-1 flex overflow-hidden p-6 space-x-6">

    <!-- Form Section -->
    <section class="w-1/3 flex flex-col space-y-6 overflow-y-auto bg-white border border-gray-200 rounded-xl shadow-md p-6">

      <!-- Multi Select -->
      <div>
        <label for="multi" class="block mb-2 font-medium text-gray-700">
          選擇創建表格的表頭（由左至右）
        </label>
        <select id="multi" multiple
          class="w-full border border-gray-300 rounded-lg p-2 shadow-sm
                 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <option value="Temporary Id">臨時編號</option>
          <option value="Remediation Status">修補狀態</option>
          <option value="Status Updated">狀態更新</option>
          <option value="Assigned To">指派人員</option>
          <option value="Updated By">更新人員</option>
          <option value="Refresh Status">複檢狀態</option>
          <option value="Comments">評論</option>
          <option value="Assets">資產</option>
          <option value="Finding Identifier">識別指標</option>
          <option value="Rolledup Observation Id" selected>Rolled Up ID</option>
          <option value="Risk Vector">風險向量</option>
          <option value="Key Evidence">關鍵證據</option>
          <option value="Web App Security Test">網頁應用程式安全測試</option>
          <option value="Status">狀態</option>
          <option value="Issue Type">問題類型</option>
          <option value="Title">標題</option>
          <option value="First Seen">初次發現時間</option>
          <option value="Last Seen">最後發現時間</option>
          <option value="Assigned To Email">指派郵件信箱</option>
          <option value="Description">描述</option>
          <option value="Severity">嚴重性</option>
          <option value="Supplier">供應者</option>
          <option value="Finding Hash">發現雜湊值</option>
          <option value="Details">問題細節</option>
          <option value="Assets.1">資產</option>
          <option value="URL">網址</option>
          <option value="Web App Security Test.1">網頁應用程式安全測試</option>
          <option value="Scan Date">檢測日期</option>
          <option value="Scanner">檢測器</option>
          <option value="Category">目錄</option>
          <option value="Observation Id">觀測編號</option>
          <option value="Observation Title">觀測標題</option>
          <option value="Observation Description">觀測描述</option>
          <option value="CWE">通用弱點列舉</option>
          <option value="CVSS">通用漏洞評分系統</option>
          <option value="Version">版本</option>
          <option value="Scope">範圍</option>
          <option value="Region">區域</option>
          <option value="Country">國家</option>
          <option value="IP">網際協定</option>
          <option value="Port">通訊埠</option>
          <option value="Vendor">供應商</option>
          <option value="Type">類別</option>
          <option value="Name">名稱</option>
          <option value="Source">來源</option>
          <option value="Directive">指示</option>
          <option value="Value">數值</option>
          <option value="Resource">資源</option>
          <option value="Resolution">解決方法</option>
          <option value="Hash">雜湊值</option>
          <option value="Path">路徑</option>
          <option value="CVE">公共漏洞和暴露</option>
          <option value="responseChain">回應鏈</option>
          <option value="attributes">屬性</option>
          <option value="Certificate">憑證</option>
          <option value="CMS">CMS</option>
          <option value="Location">位置</option>
        </select>

        <ul id="selected-list" class="mt-2 list-disc list-inside text-gray-600"></ul>
      </div>

      <!-- CSV File Input -->
      <div>
        <label for="csvFile" class="block mb-2 font-medium text-gray-700">選擇 CSV 檔案</label>
        <input type="file" id="csvFile" name="csvFile" accept=".csv"
          class="w-full border border-gray-300 rounded-lg p-2 shadow-sm
                 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
      </div>

      <!-- Risk Vector Dropdown -->
      <div>
        <label for="riskVector" class="block mb-2 font-medium text-gray-700">
          Risk Vector (風險向量)
        </label>
        <select id="riskVector"
          class="w-full border border-gray-300 rounded-lg p-2 shadow-sm
                 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <option value="Botnet Infections">Botnet Infections (殭屍網路感染)</option>
          <option value="Spam Propagation">Spam Propagation (垃圾郵件傳播)</option>
          <option value="Malware Servers">Malware Servers (惡意軟體伺服器)</option>
          <option value="Unsolicited Communications">Unsolicited Communications (未經請求的通訊)</option>
          <option value="Potentially Exploited">Potentially Exploited (潛在被利用)</option>
          <option value="File Sharing">File Sharing (檔案分享)</option>
          <option value="Exposed Credentials">Exposed Credentials (外洩機敏資料)</option>
          <option value="Security Incidents/Breaches">Security Incidents/Breaches (安全事件/漏洞)</option>
          <option value="Other Disclosures">Other Disclosures (其他揭露)</option>
          <option value="SPF Domains">SPF Domains (寄件者政策架構網域)</option>
          <option value="DKIM Records">DKIM Records (域名金鑰辨識郵件紀錄)</option>
          <option value="TLS/SSL Certificates">TLS/SSL Certificates (加密憑證)</option>
          <option value="TLS/SSL Configurations">TLS/SSL Configurations (加密設定)</option>
          <option value="Open Ports">Open Ports (開放通訊埠)</option>
          <option value="Web Application Security">Web Application Security (網頁應用程式安全)</option>
          <option value="Patching Cadence">Patching Cadence (補丁修補週期)</option>
          <option value="Insecure Systems">Insecure Systems (不安全系統)</option>
          <option value="Server Software">Server Software (伺服器軟體)</option>
          <option value="Desktop Software">Desktop Software (桌面軟體)</option>
          <option value="Mobile Software">Mobile Software (行動應用程式)</option>
          <option value="DNSSEC Records">DNSSEC Records (DNS數位簽章紀錄)</option>
          <option value="Mobile Application Security">Mobile Application Security (行動應用程式安全)</option>
          <option value="Web Application Headers">Web Application Headers (網站應用程式標頭)</option>
          <option value="DMARC">DMARC (基於網域的訊息認證，報告和一致性)</option>
          <option value="Domain Squatting">Domain Squatting (域名搶先註冊)</option>
        </select>
      </div>

      <!-- Buttons -->
      <div class="flex gap-4">
        <button type="button" id="createTableBtn" disabled
          class="w-36 bg-green-600/50 text-white font-semibold py-3 rounded-lg
                 shadow cursor-not-allowed transition duration-150">
          創建表格
        </button>
        <button type="button" id="resetBtn"
          class="w-32 bg-gray-300 text-gray-800 font-semibold py-3 rounded-lg
                 shadow hover:bg-gray-400 active:bg-gray-500 transition duration-150">
          重置
        </button>
      </div>

    </section>

    <!-- Result Section -->
    <section class="flex-1 bg-white border border-gray-200 rounded-xl shadow-md p-4 overflow-auto">
      <h2 class="text-lg font-medium mb-2">結果</h2>
      <pre id="result" class="h-full w-full text-sm overflow-auto text-gray-800"></pre>
    </section>

  </main>

  <!-- External Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
  <script src="app.js"></script>

</body>
</html>
